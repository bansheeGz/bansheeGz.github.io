#set page=Google Sheets
#set subPage=OAuth data source setup

<h4>Prerequisites</h4>
<p>
    Make sure you use BGDatabase version >= 1.7.6 (Settings->Main) and GoogleSheets plug-in version >= 1.5
    (Plug-ins->GoogleSheets integration For Editor)
</p>
<h4>Create Google client Id</h4>
<p>
    Here is our step-by-step guide how to do it (alternatively use this Google support <a
        href="https://support.google.com/googleapi/answer/6158849">article</a>)
</p>
<ol>
    <li>Log in to <a href="https://console.developers.google.com/">Google Console</a></li>
    <li>Select or create a project
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets1.png"><img style="width: 400px; height: 100px"
                                                                        src="../../../../images/BGDatabase/GoogleSheets1.png"></a>
        </div>
    </li>
    <li>
        Enable GoogleSheets API if it's disabled. Wait several minutes after enabling API.
        ( <a href="https://support.google.com/googleapi/answer/6158841?hl=en" target="_blank">Google's guide</a>, search
        for sheets)
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets22.png"><img style="width: 400px; height: 100px"
                                                                         src="../../../../images/BGDatabase/GoogleSheets22.png"></a>
        </div>
    </li>
    <li>
        Make sure your project state is "In production" under "Oauth consent screen", otherwise your tokens may expire
        every week and you will need to renew them.
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets23.png"><img style="width: 400px; height: 100px"
                                                                         src="../../../../images/BGDatabase/GoogleSheets23.png"></a>
        </div>
    </li>
    <li>Select <code>Credentials</code> , click on <code>Create credentials</code> and choose <code>Oath client
        Id</code>
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets2.png"><img style="width: 400px; height: 100px"
                                                                        src="../../../../images/BGDatabase/GoogleSheets2.png"></a>
        </div>
    </li>
    <li>Select <code>Desktop app</code> and click <code>Create</code>
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets3.png"><img style="width: 400px; height: 100px"
                                                                        src="../../../../images/BGDatabase/GoogleSheets3.png"></a>
        </div>
    </li>
    <li>A popup will show up with your client id and client secret. Copy them to your Datasource settings
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets5.png"><img style="width: 400px; height: 100px"
                                                                        src="../../../../images/BGDatabase/GoogleSheets5.png"></a>
        </div>
    </li>
    <li>Fill <code>Application name</code> with any value</li>
    <li>Open up your spreadsheet in your browser, copy the URL, click on <code>Retrieve from URL</code> button, paste
        the URL and click on <code>Parse</code> button
        to fill Spreadsheet ID (alternatively
        read <a href="https://developers.google.com/sheets/api/guides/concepts#spreadsheet_id" target="_blank">this
            article</a>
        to learn how to obtain SpreadsheetID)
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets-Oauth1.png"><img style="width: 400px; height: 100px"
                                                                              src="../../../../images/BGDatabase/GoogleSheets-Oauth1.png"></a>
        </div>
    </li>

</ol>


<h4>Get Oath tokens from Google</h4>
<ol>
    <li>Click on <code>Get new tokens</code> button
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets6.png"><img style="width: 400px; height: 100px"
                                                                        src="../../../../images/BGDatabase/GoogleSheets6.png"></a>
        </div>
    </li>
    <li>Your browser will open up, with login screen. Login to your Google account.
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets12.png"><img style="width: 400px; height: 100px"
                                                                         src="../../../../images/BGDatabase/GoogleSheets12.png"></a>
        </div>
    </li>
    <li>At this point warning screen may appear, saying application is not verified. Click on "Advanced" and then "Go"
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets13.png"><img style="width: 400px; height: 100px"
                                                                         src="../../../../images/BGDatabase/GoogleSheets13.png"></a>
        </div>
    </li>
    <li>Next screen let you grant a permission to access Google Sheets. Click on "Allow"
        <div class="bg-image">
            <a href="../../../../images/BGDatabase/GoogleSheets14.png"><img style="width: 400px; height: 100px"
                                                                         src="../../../../images/BGDatabase/GoogleSheets14.png"></a>
        </div>
    </li>
    <li>
        [Last step] After that there are 2 possible scenarios:
        <h6>Scenario #1</h6>
        <div>
            The following page will be displayed in your browser:
            <div class="bg-image">
                <a href="../../../../images/BGDatabase/GoogleSheets18.png"><img style="width: 400px; height: 100px"
                                                                             src="../../../../images/BGDatabase/GoogleSheets18.png"></a>
            </div>
            Close this page and switch back to Unity- tokens values should be updated. Save the settings. The end of the
            guide.
            <div class="bg-image">
                <a href="../../../../images/BGDatabase/GoogleSheets10.png"><img style="width: 400px; height: 100px"
                                                                             src="../../../../images/BGDatabase/GoogleSheets10.png"></a>
            </div>
        </div>
        <h6>Scenario #2</h6>
        <div>
            The following page will be displayed in your browser:
            <div class="bg-image">
                <a href="../../../../images/BGDatabase/GoogleSheets19.png"><img style="width: 400px; height: 100px"
                                                                             src="../../../../images/BGDatabase/GoogleSheets19.png"></a>
            </div>
            In this case, copy URL from browser to text editor and locate the <code>code</code> HTTP GET parameter
            value. Copy it to the clipboard (Ctrl+c).
            <div class="bg-image">
                <a href="../../../../images/BGDatabase/GoogleSheets20.png"><img style="width: 400px; height: 100px"
                                                                             src="../../../../images/BGDatabase/GoogleSheets20.png"></a>
            </div>
            Switch back to Unity Editor, click on "I want to enter code manually" button in the "Google token receiver"
            window and
            paste <code>code</code> value to "Code" parameter and press on "Go!" button
            <div class="bg-image">
                <a href="../../../../images/BGDatabase/GoogleSheets21.png"><img style="width: 400px; height: 100px"
                                                                             src="../../../../images/BGDatabase/GoogleSheets21.png"></a>
            </div>
            Tokens values should be updated. Save the settings.
            <div class="bg-image">
                <a href="../../../../images/BGDatabase/GoogleSheets10.png"><img style="width: 400px; height: 100px"
                                                                             src="../../../../images/BGDatabase/GoogleSheets10.png"></a>
            </div>
        </div>
    </li>
</ol>
