#set page=Google Sheets

<div class="importantNote">
    Main article about Export/Import is <a href="../../ExportImport">here</a>
</div>
<br/>

<h4>Description</h4>
Setting up Google sheets may take a while, however it's one-time procedure


<h4>Create Google Sheets DataSource</h4>
<p>
    Open BGDatabase window <code>Window->BGDatabase</code>
</p>
<p>
    Go to <code>DataSources</code> tab, press plus icon, chose <code>Datasource type</code>  to be <code>GoogleSheets</code> and click <code>Add</code> button
</p>
<div class="bg-image">
    <a href="#path images/BGDatabase/GoogleSheets4.png"><img style="width: 400px" src="#path images/BGDatabase/GoogleSheets4.png"></a>
</div>


<h4>Create Google client Id</h4>
<p>
    Here is our step-by-step guide how to do it (alternatively use this Google support <a href="https://support.google.com/googleapi/answer/6158849">article</a>)
</p>
<ol>
    <li>Log in to <a href="https://console.developers.google.com/">Google Console</a></li>
    <li>Select or create a project
        <div class="bg-image">
            <a href="#path images/BGDatabase/GoogleSheets1.png"><img style="width: 400px" src="#path images/BGDatabase/GoogleSheets1.png"></a>
        </div>
    </li>
    <li>Select <code>Credentials</code> , click on <code>Create credentials</code> and chose <code>Oath client Id</code>
        <div class="bg-image">
            <a href="#path images/BGDatabase/GoogleSheets2.png"><img style="width: 400px" src="#path images/BGDatabase/GoogleSheets2.png"></a>
        </div>
    </li>
    <li>Chose <code>Other</code> and click <code>Create</code>
        <div class="bg-image">
            <a href="#path images/BGDatabase/GoogleSheets3.png"><img style="width: 400px" src="#path images/BGDatabase/GoogleSheets3.png"></a>
        </div>
    </li>
    <li>A popup will show up with your client id and client secret. Copy them to your Datasource settings
        <div class="bg-image">
            <a href="#path images/BGDatabase/GoogleSheets5.png"><img style="width: 400px" src="#path images/BGDatabase/GoogleSheets5.png"></a>
        </div>
    </li>
</ol>

<h4>Filling Application name and Spreadsheet Id</h4>
<ol>
    <li>Fill <code>Application name</code> with any string value</li>
    <li>Fill <code>Spreadsheet Id</code> with your spreadsheet ID.
        Please, see the image below to learn how to obtain ID or read <a href="https://developers.google.com/sheets/api/guides/concepts#spreadsheet_id">this</a>
    </li>
</ol>
<div class="bg-image">
    <a href="#path images/BGDatabase/GoogleSheets11.png"><img style="width: 400px" src="#path images/BGDatabase/GoogleSheets11.png"></a>
</div>

<h4>Get Oath tokens from Google</h4>
<ol>
    <li>Click on <code>Get new tokens</code> button
        <div class="bg-image">
            <a href="#path images/BGDatabase/GoogleSheets6.png"><img style="width: 400px" src="#path images/BGDatabase/GoogleSheets6.png"></a>
        </div>
    </li>
    <li>Your browser will open up, with login to Google account and permission request. Login and click <code>Allow</code>
        <div class="bg-image">
            <a href="#path images/BGDatabase/GoogleSheets7.png"><img style="width: 400px; height: 100px" src="#path images/BGDatabase/GoogleSheets7.png"></a>
        </div>
    </li>
    <li>Single page will be displayed with single text field. Copy it's value and switch back to Unity
        <div class="bg-image">
            <a href="#path images/BGDatabase/GoogleSheets8.png"><img style="width: 400px; height: 100px" src="#path images/BGDatabase/GoogleSheets8.png"></a>
        </div>
    </li>

    <li>Unity will display a small popup window with single text field. Paste the copied value and press <code>Go!</code>
        <div class="bg-image">
            <a href="#path images/BGDatabase/GoogleSheets9.png"><img style="width: 400px; height: 100px" src="#path images/BGDatabase/GoogleSheets9.png"></a>
        </div>
    </li>

    <li>That's it. Tokens field will be filled and you can save settings- datasource is ready.
        <div class="bg-image">
            <a href="#path images/BGDatabase/GoogleSheets10.png"><img style="width: 400px;" src="#path images/BGDatabase/GoogleSheets10.png"></a>
        </div>
    </li>
</ol>

<h4>Create Export/Import task</h4>
<p>
    Go to <code>Export/Import</code> tab, press plus icon, chose <code>Job type</code>  to be <code>GoogleSheets</code> and click <code>Add</code> button
</p>
<p>
    Chose GoogleSheets datasource, created above. Set up metas (tables) you wish to update.
</p>

<h4>Running Export/Import Task</h4>
<p>
    Press <code>Export</code> or <code>Import</code> button to run the task you just created.
</p>

<p>
    [Optionally] After job is finished, open <code>Log</code> tab to see full log of all actions performed.
    Pay attention to Warning messages (colored red). Every error or unexpected event happened during syncing will be colored red.
</p>
<div class="bg-image">
    <a href="#path images/BGDatabase/Excel5.png"><img style="width: 400px" src="#path images/BGDatabase/Excel5.png"></a>
</div>

<div class="importantNote">
    Target empty spreadsheet while exporting for the first time. Export job will create necessary sheets/header rows + data for you
</div>
<p>
    Make sure you have as many physical rows/columns as you need, delete empty rows/columns to boost performance.
</p>

<h4>Using Google sheets as shared remote database</h4>
<p>
    You can use Google Sheets as remote shared database to be used by several developers (during game development).
</p>

<h4>GoogleSheets API v.4 and Older Unity versions</h4>
<p>
    Since BGDatabase v.1.5 we switched from Google Sheets API v.3 to v.4.
    If you use Unity 2017-2018, make sure your scripting runtime is set to 4.x. Read more details <a href="../../../Blog/BGDatabase-GoogleSheetsV4">here</a>
</p>

