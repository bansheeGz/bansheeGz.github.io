#set page=Google Sheets

<div class="importantNote">
    Main article about Export/Import is <a href="../../ExportImport">here</a>
</div>
<br/>

<h4>Create Google Sheets DataSource</h4>
<p>
    Open BGDatabase window <code>Window->BGDatabase</code>
</p>
<p>
    Go to <code>DataSources</code> tab, press plus icon, chose <code>Datasource type</code> to be <code>GoogleSheets</code> and click <code>Add</code> button
</p>
<p class="redText">
    [Important]: Keep your settings file private if you use GoogleSheets. Do not share it with anyone
</p>
<div class="bg-image">
    <a href="#path images/BGDatabase/GoogleSheets4.png"><img style="width: 400px" src="#path images/BGDatabase/GoogleSheets4.png"></a>
</div>


<h4>Setting up Google Sheets DataSource</h4>
<div>
    Setting up Google Sheets DataSource depends on authentication type. Chose authentication type and read setup guide for this type.
</div>

<table class="contentTable">
    <tr>
        <th width="20%">
        </th>
        <th width="20%">
            OAuth 2.0 (default)
        </th>
        <th width="20%">
            Service
        </th>
        <th width="20%">
            API Key
        </th>
        <th width="20%">
            Anonymous
        </th>
    </tr>
    <tr>
        <td>
            Access
        </td>
        <td>
            Read/Write to all spreadsheets
        </td>
        <td>
            Read/Write to all spreadsheets
        </td>
        <td>
            Read-only to public/shared spreadsheets
        </td>
        <td>
            Read-only to public/shared spreadsheets. No access to input value
        </td>
    </tr>
    <tr>
        <td>
            Additional details
        </td>
        <td>
            This is recommended method
        </td>
        <td>
            It requires service email to be added to authorized users list for chosen spreadsheet
        </td>
        <td>
            Easy to setup, but <br/>1) readonly <br/>2) requires spreadsheet to be shared or public
        </td>
        <td>
            Easiest to setup, no need for any credentials, but <br/>1) readonly <br/>2) requires spreadsheet to be shared or public <br/>3) no access to raw/input value
        </td>
    </tr>
    <tr>
        <td>
            Setup guide
        </td>
        <td>
            <a href="setup-oauth.html" target="_blank">read</a>
        </td>
        <td>
            <a href="setup-service.html" target="_blank">read</a>
        </td>
        <td>
            <a href="setup-apikey.html" target="_blank">read</a>
        </td>
        <td>
            <a href="setup-anonymous.html" target="_blank">read</a>
        </td>
    </tr>
</table>

<h4>Create Export/Import task</h4>
<p>
    Go to <code>Export/Import</code> tab, press plus icon, chose <code>Job type</code> to be <code>GoogleSheets</code> and click <code>Add</code> button
</p>
<p>
    Chose GoogleSheets datasource, created above. Set up metas (tables) you wish to update.
</p>

<h4>Running Export/Import Task</h4>
<p>
    Press <code>Export</code> or <code>Import</code> button to run the task you just created.
</p>

<p>
    [Optionally] After job is finished, open <code>Log</code> tab to see full log of all actions performed.
    Pay attention to Warning messages (colored red). Every error or unexpected event happened during syncing will be colored red.
</p>
<div class="bg-image">
    <a href="#path images/BGDatabase/Excel5.png"><img style="width: 400px" src="#path images/BGDatabase/Excel5.png"></a>
</div>

<div class="importantNote">
    Target empty spreadsheet while exporting for the first time. Export job will create necessary sheets/header rows + data for you
    (<a href="../../ExportImport/index.html#firstTime">more information</a>)
</div>
<p>
    Make sure you have as many physical rows/columns as you need, delete empty rows/columns to boost performance.
</p>

<h4 id="shared">Using Google sheets as shared remote database</h4>
<p>
    You can use Google Sheets as remote shared database to be used by several developers (during game development)
</p>
<p>
    Starting with version 1.5.4, we enforce locking mechanism to ensure only one export job is running at a time to avoid possible data collision.
    We use separate sheet (_dblock_) with one single cell (A1) to hold the lock value.
    Unfortunately this mechanism is not 100% solid and there is still a tiny chance 2 export jobs run at the same time- in this case you will get a warning message after the export.
    If you see this warning- review GoogleSheets data to make sure everything is ok and export data one more time if there is any issue.
</p>


<h4>GoogleSheets API v.4 and Older Unity versions</h4>
<p>
    Since BGDatabase v.1.5 we switched from Google Sheets API v.3 to v.4.
    If you use Unity 2017-2018, make sure your scripting runtime is set to 4.x. Read more details <a href="../../../Blog/BGDatabase-GoogleSheetsV4">here</a>
</p>

