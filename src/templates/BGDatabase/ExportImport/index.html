#set page=Export Import

<h4>What can I do with export/import?</h4>
<ol>
    <li>Export/import any data to/from GoogleSheets/Excel in Editor (during game development)</li>
    <li>Monitor excel file and auto-import data in Editor and at runtime (from builds) with our extension packages, which can be downloaded <a href="../Downloads">here</a> (PC/Mac/Linux only)</li>
    <li>Update database data on players devices at runtime from GoogleSheets with <a href="../Addons/LiveUpdate">LiveUpdate</a> plugin</li>
    <li><span style="color: red">Currently there is no way to write to GoogleSheets at runtime from players devices </span>(<a href="#why">Why not?</a>)</li>
    <li>Backup/restore database in json format in Editor</li>
</ol>


<h4>Description</h4>
<p>
    You can edit database data in external tools, such as Excel/Open Office/Libre Office or Google Sheets.
</p>
<p>
    BG Database provide export/import functions to xls files, Google Sheets and json (backup only).
</p>
<p>
    Full import/export works in Editor only, but you can update database data on players devices from GoogleSheets
    with <a href="../Addons/LiveUpdate">LiveUpdate addon</a>.
    No way to update GoogleSheets data from players devices yet.
</p>

<p>
    Use json export/import to create full database backup.
</p>

<p>
    This article describes common procedure and ideas, common for both Excel and Google Sheets.
    You can find provider' specific instruction here:
    for <a href="../ThirdParty/Excel">Excel/Open Office</a>, for <a href="../ThirdParty/GoogleSheets">Google Sheets</a>
</p>

<h4>General idea</h4>
Here is the illustration about how BGDatabase data is mapped to spreadsheets.
<div class="bg-image">
    <a href="#path images/BGDatabase/ExportImport1.png"><img style="width: 400px"
                                                             src="#path images/BGDatabase/ExportImport1.png"></a>
</div>

<h4 id="mergeSettings">Using merge settings</h4>
<p>
    You have full control over which data you want to synchronize: you can add, delete, update and you can chose which
    fields you wish to update.
</p>
<p>
    Here is how it works:
    Every synchronization has a source and a destination.
    If you are exporting data from BDDatabase to, let's say, Excel file- the source is BGDatabase and a destination- is
    Excel file.
    Here is how data is classified during syncing:
</p>
<div class="bg-image">
    <a href="#path images/BGDatabase/ExportImport2.png"><img style="width: 400px"
                                                             src="#path images/BGDatabase/ExportImport2.png"></a>
</div>
<p>
    So, there are 3 types of rows during syncing:
</p>
<ol>
    <li>Matching rows : they exists in the Source and in the Destination. Can be updated and you can chose which fields
        to update.
    </li>
    <li>Missing rows : they exists only in the Source. Can be added to Destination.</li>
    <li>Orphaned rows : they exists only in the Destination. Can be removed from Destination.</li>
</ol>
<p>
    Let's look at merge settings and find out how we can define actions to take during syncing
</p>
<div class="bg-image">
    <a href="#path images/BGDatabase/ExportImport3.png"><img style="width: 400px"
                                                             src="#path images/BGDatabase/ExportImport3.png"></a>
</div>

<h4 id="rowlevel">Row-level control for merge settings</h4>
<p>Merge settings let you configure which table/fields you want to add/delete/update, but it does not give you the opportunity to define which rows you want to add/delete/update</p>
<p>For row-level control, you can implement C# controller class, which can cancel any operation if some condition is met. This is how:</p>
<ul>
    <li>Create your own C# class with unique name, set this class name to "Controller Type" field of merge settings (using the full name with namespace).</li>
    <li>Implement any number of interfaces (namespace is <code>BansheeGz.BGDatabase</code>, interfaces defined inside class <code>BGMergeSettingsEntity</code>),
        listed below to receive callback method invocations. Return true from this methods to cancel operation</li>
</ul>
<table  class="contentTable">
    <tr>
        <th width="20%">Interface type</th>
        <th width="40%">method(s) to implement</th>
        <th width="40%">description</th>
    </tr>
    <tr>
        <td>IMergeReceiver</td>
        <td>
            <code>public bool OnBeforeMerge(BGRepo from, BGRepo to)</code>
            <br>
            <code>public void OnAfterMerge(BGRepo @from, BGRepo to)</code>
        </td>
        <td>
            Callbacks to be called before after merging. Return true from OnBeforeMerge to cancel merging
        </td>
    </tr>
    <tr>
        <td>IRemoveOrphanedReceiver</td>
        <td>
            <code>public bool OnBeforeDelete(BGEntity toEntity)</code>
        </td>
        <td>
            Callbacks to be called before deleting the row. Return true to cancel removal.
        </td>
    </tr>
    <tr>
        <td>IAddMissingReceiver</td>
        <td>
            <code>public bool OnBeforeAdd(BGEntity fromEntity)</code>
        </td>
        <td>
            Callbacks to be called before adding the row. Return true to cancel adding.
        </td>
    </tr>
    <tr>
        <td>IUpdateMatchingReceiver</td>
        <td>
            <code>public bool OnBeforeUpdate(BGEntity @from, BGEntity to)</code>
        </td>
        <td>
            Callbacks to be called before updating the row. Return true to cancel updating.
        </td>
    </tr>
    <tr>
        <td>IUpdateMatchingFieldReceiver</td>
        <td>
            <code>public bool OnBeforeFieldUpdate(BGField fromField, BGField toField, BGEntity @from, BGEntity to)</code>
        </td>
        <td>
            Callbacks to be called before updating the row' field. The same as <code>IUpdateMatchingReceiver</code>,
            but it's called on per field basis. <code>IUpdateMatchingReceiver</code> is called before this callback,
            and if <code>IUpdateMatchingReceiver</code> return true, this callback will never be invoked (cause updating entity will be cancelled by <code>IUpdateMatchingReceiver</code>)
        </td>
    </tr>
</table>
<p>
    You can find an example of such controller class on <a href="../Addons/SaveLoad#rowlevelexample">Save/Load</a> addon page.
</p>

<h4>Default field value string format</h4>
<p>
    We use Acute (Back quote) symbol <code>`</code> to separate tokens of single value, for example Vector3.zero is
    <code>0`0`0</code>
</p>
<p>
    We use Vertical bar (Pipe) symbol <code>|</code> to separate values of the list, for example List&lt;bool&gt; is
    <code>0|1|0</code>
</p>
<div class="bg-image">
    <a href="#path images/BGDatabase/ExportImport4.png"><img style="width: 400px"
                                                             src="#path images/BGDatabase/ExportImport4.png"></a>
</div>


<h4>Custom field value string format</h4>
<p>
    Most of the fields support custom string format (except for Unity assets and relations).
    You can create your own class, implementing BGStringFormatter&lt;T&gt; interface (T is a field value type) and assign it under "M" menu as a custom string value formatter
</p>


<h4>Adding rows in external tools</h4>
<p>
    Each row has it's own id- 22 symbols string.
    It's computer-generated value, based on Guid generation.
</p>
<p>
    While creating rows in external tool, you can leave it blank, and it will be updated during importing procedure
    (make sure you toggled "Update Ids on Import" on)
</p>
<div class="bg-image">
    <a href="#path images/BGDatabase/ExportImport5.png"><img style="width: 400px"
                                                             src="#path images/BGDatabase/ExportImport5.png"></a>
</div>

<h4>Creating database backup in json format</h4>
<p>
    Exporting data to json allows you to create a full database backup in human readable form as json file.
    With json you can not chose which data you want to be exported/imported, full data including database structure will
    be included.
</p>
<p>
    You can use this backup later to fully restore the database (including structure)
</p>

<h4>Tables naming restriction</h4>
<p>
    If you plan to use Excel/GoogleSheets, avoid giving your tables similar names with only difference in lower/upper letter(s) (like "test" "Test", "tESt" etc.).
    It will work fine with BGDatabase, however both Excel and GoogleSheets consider such names to be equal, and it will result in errors when you try to export the data.
</p>

<h4 id="why">Why you do not provide an option to update GoogleSheets data from player devices?</h4>
<p>
    We believe giving direct write GoogleSheets access to player devices does not make much sense, due to the following
    reasons:
</p>
<ol>
    <li>Durability problem: this is the main reason- there is no way to make sure some change will not erase previous change.
        Let's say you want to store the number of times your app was launched.
        So you read cell value, you increase it by 1 and you write it back.
        But if 10 players launch your game simultaneously,
        they all read initial zero value from GoogleSheets, increase it by one and write it back, so the final value will be 1, not 10.
        This problem apply to any shared data.
    </li>
    <li>Security problem: giving write access means giving credentials to change data, and there is no way to make sure these credentials will not be hacked</li>
    <li>Performance problem: GoogleSheets is not fast enough to be used as online database for big amount of users.
        Many tasks will require to read data first before updating, and it can take a lot of time.
        Also there is 2 million cells max restriction.
    </li>
</ol>
<p>
    All this problems can be solved with a proxy server, but it means there is no need for direct access to GoogleSheets.
    If you are still looking for a way to write data to GoogleSheets from players devices
    <a href="https://developers.google.com/sheets/api/">GoogleSheets dotnet API library v4</a> is probably the best starting point.

</p>


<h4>What's next?</h4>
Read product specific guides next
<ol>
    <li><a href="../ThirdParty/Excel">Excel/Open Office</a></li>
    <li><a href="../ThirdParty/GoogleSheets">Google Sheets</a></li>
</ol>
