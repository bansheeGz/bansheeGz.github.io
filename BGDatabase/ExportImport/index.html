<!doctype html>
<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-76367732-7"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-76367732-7');
    </script>

    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="BG Database is a in-game data management system for Unity3D game engine">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    
    <title>BansheeGz</title>

    <!-- Page styles -->
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="../../css/font-awesome.min.css">
    <link rel="stylesheet" href="https://code.getmdl.io/1.2.1/material.min.css">

    <link rel="stylesheet" href="../../css/main.css">
    <link rel="stylesheet" href="../../css/page.css">

    <link rel="icon" type="image/png" href="../../images/BGIcon.png"/>
</head>
<body>


<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>-->
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

<style>
    #aBox a {
        color: white;
        font: 15px Helvetica, Arial, Sans-Serif;
    }

    #bg-navigation a {
        background-position: 50px;
    }
</style>


<script>
    function writeEmail(whom, at) {
        document.write("<a href='mail" + "to:" + whom + "@" + at + "'>" + whom + "@" + at + "</a>");
    }
</script>

<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">

    <!--======================================================       Root  Header               -->
    <div class="bg-header mdl-layout__header mdl-layout__header--waterfall">
        <div class="mdl-layout__header-row" id="header">
          <span style="margin-left: -40px;">
              <a class="bg-header-a" href="/"><img src="../../images/BGIconBig.png"></a>
          </span>
            <!-- Add spacer, to align navigation to the right in desktop -->
            <div class="mdl-layout-spacer"></div>
            <!-- Navigation -->
            <div class="bg-navigation-bag" id="bg-navigation">
                <nav class="bg-navigation mdl-navigation">
                    <a class="mdl-navigation__link mdl-typography--text-uppercase bg-navigation_link_active"
                       href="../../BGDatabase">BG`Database</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../BGLocalization">BG`Localization</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../BGCurve">BG`Curve</a>
<!--                    <a class="mdl-navigation__link mdl-typography&#45;&#45;text-uppercase "-->
<!--                       href="../../BGCurve/BGSplineColliders">BG`Spline_Colliders</a>-->
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../Blog">Blog</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../Support">Support</a>
                </nav>
            </div>
            <button class="bg-menu-mobile mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect"
                    id="more-button">
                <i class="material-icons">more_vert</i>
            </button>
            <ul class="bg-menusub-mobile mdl-menu mdl-js-menu mdl-menu--bottom-right mdl-js-ripple-effect"
                for="more-button">
                <li class="mdl-menu__item"><a href="../../BGDatabase">BG Database</a></li>
                <li class="mdl-menu__item"><a href="../../BGLocalization">BG Localization</a></li>
                <li class="mdl-menu__item"><a href="../../BGCurve">BG Curve</a></li>
                <li class="mdl-menu__item"><a href="../../Support">Support</a></li>
                <li class="mdl-menu__item"><a href="../../About">About Us</a></li>
            </ul>
        </div>
    </div>

    <!--
        <div style="min-height: 5px;background-color: #CCCCCC"></div>
        <div id="aBox" style="background-color: #ff69b4;height: 20px;color: white;text-align: center;">
            <b>
                Announcement: <a href="../../BGDatabase"><b>BG Database</b></a> v. 1.1 is out!
        </b>
    </div>
    -->

    <div class="mdl-layout__content">
        <a name="top"></a>


        <!--======================================================        Content (from Root)              -->
        




<link rel="stylesheet" href="../../css/bgdatabase.css">
<link rel="stylesheet" href="../../css/magnific-popup.css">
<script src="../../js/jquery.magnific-popup.min.js"></script>

<script>
    $(document).ready(function () {
        $('.bg-image').magnificPopup({
            delegate: 'a',
            type: 'image',
//            gallery:{enabled:true},
            closeOnContentClick: true
        });
    });
</script>

<!--======================================================       BG Database Header               -->


<div class="mdl-grid">
    <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-tablet mdl-cell--hide-phone bg-sm  mdl-shadow--3dp">
        <ul id="leftmenu">
            <li class="pli databaseicon ">
                <a class="pa" href="../../BGDatabase">BG Database Home</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Setup">Setup</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/HowToUse">How to use</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/GUIOverview">GUI Overview</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/CodeExamples">Code Examples</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Videos">Videos</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/SupportedFields">Field types</a>
                    </li>
                    <li class="cli  plic ">
                        <a class="ca" href="../../BGDatabase/ExportImport">Export Import</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/DataBinding">Data Binding</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/MergeTool">Merge Tool</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Misc">Misc</a>
                    </li>
                    <li class="cli downloadicon ">
                        <a class="ca" href="../../BGDatabase/Downloads">Downloads</a>
                    </li>
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../BGDatabase/CodeGeneration">Code Generation</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/CodeGeneration/ExtensionClasses">Extension Classes</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/CodeGeneration/MonoBehaviourClasses">MonoBehavior Classes</a>
                    </li>
<!--
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/CodeGeneration/DnaClasses">Dna Classes</a>
                    </li>
-->
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../BGDatabase/ThirdParty">Third-Party Integration</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/ThirdParty/Excel">Excel</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/ThirdParty/GoogleSheets">Google Sheets</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/ThirdParty/Playmaker">Playmaker</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/ThirdParty/Bolt">Bolt</a>
                    </li>
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../BGDatabase/Addons">Addons</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Addons/SaveLoad">Save Load</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Addons/CodeGeneration">Code Generation</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Addons/LazyLoad">Lazy Load</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Addons/LiveUpdate">Live Update</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Addons/Multithreading">Multithreading</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Addons/Modding">Modding</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Addons/Settings">Settings</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/Addons/Localization">Localization</a>
                    </li>
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../BGDatabase/API">API</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/API/BGRepo">BGRepo</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/API/BGMetaEntity">BGMetaEntity</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/API/BGEntity">BGEntity</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../BGDatabase/API/BGField">BGField</a>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
    <div class="mdl-cell--hide-desktop mdl-cell--hide-tablet mdl-cell--4-col-phone">
        <a class="pa" href="../../BGDatabase">BG BGDatabase Home</a>
        <a class="pa" href="../../BGDatabase/Setup">Setup</a>
        <a class="pa" href="../../BGDatabase/HowToUse">How To Use</a>
        <a class="pa" href="../../BGDatabase/Videos">Videos</a>
        <a class="pa" href="../../BGDatabase/ExampleBreakdown">Example Breakdown</a>
        <a class="pa" href="../../BGDatabase/SupportedFields">Fields</a>
        <a class="pa" href="../../BGDatabase/ExportImport">Export Import</a>
        <a class="pa" href="../../BGDatabase/DataBinding">Data Binding</a>
        <a class="pa" href="../../BGDatabase/Events">Events</a>
        <a class="pa" href="../../BGDatabase/CodeGeneration">Code Generation</a>
        <a class="pa" href="../../BGDatabase/Addons">Addons</a>
    </div>
    <div class="mdl-cell mdl-cell--9-col mdl-cell--6-col-tablet mdl-cell--3-col-phone">
        <div class="bg-main mdl-shadow--3dp">
            <div class="bg-main-title">
                <h3>Export Import</h3>
            </div>

            <!--======================================================        BG Database Content              -->
            <div id="content">
            

<h4>What can I do with export/import?</h4>
<ol>
    <li>Export/import any data to/from GoogleSheets/Excel in Editor (during game development)</li>
    <li>Monitor excel file and auto-import data in Editor and at runtime (from builds) with our extension packages, which can be downloaded <a href="../Downloads">here</a> (PC/Mac/Linux only)</li>
    <li>Update database data on players devices at runtime from GoogleSheets with <a href="../Addons/LiveUpdate">LiveUpdate</a> plugin</li>
    <li><span style="color: red">Currently there is no way to write to GoogleSheets at runtime from players devices </span>(<a href="#why">Why not?</a>)</li>
    <li>Backup/restore database in json format in Editor</li>
</ol>


<h4>Description</h4>
<p>
    You can edit database data in external tools, such as Excel/Open Office/Libre Office or Google Sheets.
</p>
<p>
    BG Database supports export/import to/from Excel files (xls and xlsx), Google Sheets and json (backup only).
</p>
<p>
    Full import/export works in Editor only, but you can update database data on players devices from GoogleSheets
    with <a href="../Addons/LiveUpdate">LiveUpdate addon</a>.
    No way to update GoogleSheets data from players devices yet.
</p>

<p>
    Use json export/import to create full database backup.
</p>

<p>
    This article describes common procedure and ideas, common for both Excel and Google Sheets.
    (click to view additional guides for <a href="../ThirdParty/Excel">Excel/OpenOffice</a> and <a href="../ThirdParty/GoogleSheets">GoogleSheets</a></i>)
</p>

<h4>General idea</h4>
Here is the illustration about how BGDatabase data is mapped to spreadsheets.
<div class="bg-image">
    <a href="../../images/BGDatabase/ExportImport1.png"><img style="width: 400px"
                                                             src="../../images/BGDatabase/ExportImport1.png"></a>
</div>

<h4>Setup guide for export/import</h4>
<ol>
    <li>Create a datasource for Excel/GoogleSheets</li>
    <li>Create a job</li>
    <li>[Optional] Chose tables/fields you want to export/import</li>
    <li>Export/import</li>
</ol>
<p>
    <i>Click for detailed guides for <a href="../ThirdParty/Excel">Excel</a> and <a href="../ThirdParty/GoogleSheets">GoogleSheets</a></i>
</p>
<p>
    Export does not require any additional steps, but if you want to import data from external datasource for the first time,
    you need to ensure the data has a proper layout (as described in "General idea" section),
    e.g. your sheets has the same name as your database tables and the first row has field names.
</p>
<div class="bg-image">
    <a href="../../images/BGDatabase/ExportImport6.png"><img style="width: 400px" src="../../images/BGDatabase/ExportImport6.png"></a>
</div>

<p>
    [Optionally] Also, if you want to create a link between your external data rows and database rows, you need to add _id column to your data
    and ensure a job's "Update ids on import" parameter is toggled on.
</p>
<div class="bg-image">
    <a href="../../images/BGDatabase/ExportImport7.png"><img style="width: 400px" src="../../images/BGDatabase/ExportImport7.png"></a>
</div>

<h4 id="mergeSettings">Using merge settings</h4>
<p>
    You have full control over which data you want to synchronize: you can add, delete, update and you can chose which
    fields you wish to update.
</p>
<p>
    Here is how it works:
    Every synchronization has a source and a destination.
    If you are exporting data from BDDatabase to, let's say, Excel file- the source is BGDatabase and a destination- is
    Excel file.
    Here is how data is classified during syncing:
</p>
<div class="bg-image">
    <a href="../../images/BGDatabase/ExportImport2.png"><img style="width: 400px"
                                                             src="../../images/BGDatabase/ExportImport2.png"></a>
</div>
<p>
    So, there are 3 types of rows during syncing:
</p>
<ol>
    <li>Matching rows : they exists in the Source and in the Destination. Can be updated and you can chose which fields
        to update.
    </li>
    <li>Missing rows : they exists only in the Source. Can be added to Destination.</li>
    <li>Orphaned rows : they exists only in the Destination. Can be removed from Destination.</li>
</ol>
<p>
    Let's look at merge settings and find out how we can define actions to take during syncing
</p>
<div class="bg-image">
    <a href="../../images/BGDatabase/ExportImport3.png"><img style="width: 400px"
                                                             src="../../images/BGDatabase/ExportImport3.png"></a>
</div>

<h4>Additional parameters</h4>
<table  class="contentTable">
    <tr>
        <th>Name</th>
        <th>Description</th>
    </tr>
    <tr>
        <td>Update Ids on import</td>
        <td>
            If you are adding new rows in external tools, leave _id column empty and enable this parameter.
            Id values from database will be transferred to _id column when you import new rows.
        </td>
    </tr>
    <tr>
        <td>Transfer rows order</td>
        <td>
            Rows order from the source will be transferred to the destination. Import/export and Excel/GoogleSheets are all supported.
        </td>
    </tr>
</table>


<h4 id="firstTime">Running Export/Import for the first time</h4>
<p>
    To be able to sync with BGDatabase, you need a corresponding structure created in Excel/GoogleSheets,
    e.g. you need sheets, named after your tables names and header columns, named after you field names (as described above in "General idea" section).
</p>
<p>
    You can easily create this structure by exporting your data to the empty spreadsheet/xls file
</p>
<ul>
    <li>Make sure to target empty spreadsheet/xls file</li>
    <li>Make sure to include all tables/fields you want to export in the settings. Included tables/fields will be highlighted in green</li>
    <li>Make sure all tables you want to include have "Add missing rows" toggle turned on.(cause all the rows will be "missing rows" when you export to empty spreadsheet)</li>
    <li>Export data once- all required structure will be created for you</li>
</ul>



<h4 id="rowlevel">Row-level control for merge settings</h4>
<p>Merge settings let you configure which table/fields you want to add/delete/update, but it does not give you the opportunity to define which rows you want to add/delete/update</p>
<p>For row-level control, you can implement C# controller class, which can cancel any operation if some condition is met. This is how:</p>
<ul>
    <li>Create your own C# class with unique name, set this class name to "Controller Type" field of merge settings (using the full name with namespace).</li>
    <li>Implement any number of interfaces (namespace is <code>BansheeGz.BGDatabase</code>, interfaces defined inside class <code>BGMergeSettingsEntity</code>),
        listed below to receive callback method invocations. Return true from this methods to cancel operation</li>
</ul>
<table  class="contentTable">
    <tr>
        <th width="20%">Interface type</th>
        <th width="40%">method(s) to implement</th>
        <th width="40%">description</th>
    </tr>
    <tr>
        <td>IMergeReceiver</td>
        <td>
            <code>public bool OnBeforeMerge(BGRepo from, BGRepo to)</code>
            <br>
            <code>public void OnAfterMerge(BGRepo @from, BGRepo to)</code>
        </td>
        <td>
            Callbacks to be called before after merging. Return true from OnBeforeMerge to cancel merging
        </td>
    </tr>
    <tr>
        <td>IRemoveOrphanedReceiver</td>
        <td>
            <code>public bool OnBeforeDelete(BGEntity toEntity)</code>
        </td>
        <td>
            Callbacks to be called before deleting the row. Return true to cancel removal.
        </td>
    </tr>
    <tr>
        <td>IAddMissingReceiver</td>
        <td>
            <code>public bool OnBeforeAdd(BGEntity fromEntity)</code>
        </td>
        <td>
            Callbacks to be called before adding the row. Return true to cancel adding.
        </td>
    </tr>
    <tr>
        <td>IUpdateMatchingReceiver</td>
        <td>
            <code>public bool OnBeforeUpdate(BGEntity @from, BGEntity to)</code>
        </td>
        <td>
            Callbacks to be called before updating the row. Return true to cancel updating.
        </td>
    </tr>
    <tr>
        <td>IUpdateMatchingFieldReceiver</td>
        <td>
            <code>public bool OnBeforeFieldUpdate(BGField fromField, BGField toField, BGEntity @from, BGEntity to)</code>
        </td>
        <td>
            Callbacks to be called before updating the row' field. The same as <code>IUpdateMatchingReceiver</code>,
            but it's called on per field basis. <code>IUpdateMatchingReceiver</code> is called before this callback,
            and if <code>IUpdateMatchingReceiver</code> return true, this callback will never be invoked (cause updating entity will be cancelled by <code>IUpdateMatchingReceiver</code>)
        </td>
    </tr>
</table>
<p>
    You can find an example of such controller class on <a href="../Addons/SaveLoad#rowlevelexample">Save/Load</a> addon page.
</p>

<h4>Default field value string format</h4>
<p>
    We use Acute (Back quote) symbol <code>`</code> to separate tokens of single value, for example Vector3.zero is
    <code>0`0`0</code>
</p>
<p>
    We use Vertical bar (Pipe) symbol <code>|</code> to separate values of the list, for example List&lt;bool&gt; is
    <code>0|1|0</code>
</p>
<div class="bg-image">
    <a href="../../images/BGDatabase/ExportImport4.png"><img style="width: 400px"
                                                             src="../../images/BGDatabase/ExportImport4.png"></a>
</div>


<h4>Custom field value string format</h4>
<p>
    Most of the fields support custom string format (except for Unity assets and relations).
    You can create your own class, implementing BGStringFormatter&lt;T&gt; interface (T is a field value type) and assign it under "M" menu as a custom string value formatter
</p>


<h4>Adding rows in external tools</h4>
<p>
    Each row has it's own id- 22 symbols string.
    It's computer-generated value, based on Guid generation.
</p>
<p>
    While creating rows in external tool, you can leave it blank, and it will be updated during importing procedure
    (make sure you toggled "Update Ids on Import" on)
</p>
<div class="bg-image">
    <a href="../../images/BGDatabase/ExportImport5.png"><img style="width: 400px"
                                                             src="../../images/BGDatabase/ExportImport5.png"></a>
</div>

<h4>Creating database backup in json format</h4>
<p>
    Exporting data to json allows you to create a full database backup in human readable form as json file.
    With json you can not chose which data you want to be exported/imported, full data including database structure will
    be included.
</p>
<p>
    You can use this backup later to fully restore the database (including structure)
</p>

<h4>Tables naming restriction</h4>
<p>
    If you plan to use Excel/GoogleSheets, avoid giving your tables similar names with only difference in lower/upper letter(s) (like "test" "Test", "tESt" etc.).
    It will work fine with BGDatabase, however both Excel and GoogleSheets consider such names to be equal, and it will result in errors when you try to export the data.
</p>

<h4 id="why">Why you do not provide an option to update GoogleSheets data from player devices?</h4>
<p>
    TLDR: Our export procedure is not meant to be executed simultaneously by multiple clients
</p>
<p>
    LONG READ: We believe giving direct write GoogleSheets access to player devices does not make much sense, due to the following
    reasons:
</p>
<ol>
    <li>Durability problem: this is the main reason- there is no way to make sure some change will not erase previous change.
        Let's say you want to store the number of times your app was launched.
        So you read cell value, you increase it by 1 and you write it back.
        But if 10 players launch your game simultaneously,
        they all read initial zero value from GoogleSheets, increase it by one and write it back, so the final value will be 1, not 10.
        This problem apply to any shared data.
    </li>
    <li>Security problem: giving write access means giving credentials to change data, and there is no way to make sure these credentials will not be hacked</li>
    <li>Performance problem: GoogleSheets is not fast enough to be used as online database for big amount of users.
        Many tasks will require to read data first before updating, and it can take a lot of time.
        Also there is 2 million cells max restriction.
    </li>
</ol>
<p>
    All this problems can be solved with a proxy server, but it also means there is no need for direct access to GoogleSheets.
</p>
<p>
    If you are still looking for a way to write data to GoogleSheets from players devices:
</p>
<ol>
    <li>If all you need is to add data to spreadsheet, you can use <a href="https://www.google.com/forms/about/">Google Forms</a>,
        <a href="https://support.google.com/docs/answer/2917686?hl=en">linked to a spreadsheet</a>
        and <a href="https://stackoverflow.com/questions/18073971/http-post-to-a-google-form">HTTP POST</a> to add data to spreadsheet</li>
    <li>If you need more sophisticated control <a href="https://developers.google.com/sheets/api/">GoogleSheets dotnet API library v4</a> is probably the best starting point.</li>
</ol>



<h4>What's next?</h4>
Read product specific guides next
<ol>
    <li><a href="../ThirdParty/Excel">Excel/Open Office</a></li>
    <li><a href="../ThirdParty/GoogleSheets">Google Sheets</a></li>
</ol>
            </div>

            <!--======================================================       BG Database Footer               -->
        </div>

    </div>
</div>



        <!--======================================================      Root Footer               -->
        <footer class="bg-footer mdl-mega-footer" style="clear:both;">
            <div class="mdl-mega-footer--top-section">
                <div class="mdl-mega-footer--middle-section bg-footer-email">
                    <table>
                        <tr>
                            <td>
                                <script language="JavaScript">
                                    writeEmail("support", "bansheegz.com")
                                </script>
                            </td>
                            <td>
                                or
                            </td>
                            <td>
                                <script language="JavaScript">
                                    writeEmail("admin", "bansheegz.com")
                                </script>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div style="text-align: center">
                <div id="share" style="display: inline-block;"></div>
            </div>
        </footer>
    </div>
</div>


</div>

<script defer src="https://code.getmdl.io/1.2.1/material.min.js"></script>

</body>
</html>
