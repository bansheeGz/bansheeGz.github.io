<!doctype html>
<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-76367732-7"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-76367732-7');
    </script>

    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="BG Database is an in-game data management system for Unity3D game engine with Google Sheets and Excel integration">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    
    <title>BansheeGz</title>

    <!-- Page styles -->
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="../../../css/font-awesome.min.css">
    <link rel="stylesheet" href="https://code.getmdl.io/1.2.1/material.min.css">

    <link rel="stylesheet" href="../../../css/main.css">
    <link rel="stylesheet" href="../../../css/page.css">

    <link rel="icon" type="image/png" href="../../../images/BGIcon.png"/>
</head>
<body>


<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>-->
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

<style>
    #aBox a {
        color: white;
        font: 15px Helvetica, Arial, Sans-Serif;
    }

    #bg-navigation a {
        background-position: 50px;
    }
</style>


<script>
    function writeEmail(whom, at) {
        document.write("<a href='mail" + "to:" + whom + "@" + at + "'>" + whom + "@" + at + "</a>");
    }
</script>

<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">

    <!--======================================================       Root  Header               -->
    <div class="bg-header mdl-layout__header mdl-layout__header--waterfall">
        <div class="mdl-layout__header-row" id="header">
          <span style="margin-left: -40px;">
              <a class="bg-header-a" href="/"><img src="../../../images/BGIconBig.png"></a>
          </span>
            <!-- Add spacer, to align navigation to the right in desktop -->
            <div class="mdl-layout-spacer"></div>
            <!-- Navigation -->
            <div class="bg-navigation-bag" id="bg-navigation">
                <nav class="bg-navigation mdl-navigation">
                    <a class="mdl-navigation__link mdl-typography--text-uppercase bg-navigation_link_active"
                       href="../../../BGDatabase">BG`Database</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../../BGLocalization">BG`Localization</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../../BGCurve">BG`Curve</a>
<!--                    <a class="mdl-navigation__link mdl-typography&#45;&#45;text-uppercase "-->
<!--                       href="../../../BGCurve/BGSplineColliders">BG`Spline_Colliders</a>-->
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../../Blog">Blog</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../../Support">Support</a>
                </nav>
            </div>
            <button class="bg-menu-mobile mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect"
                    id="more-button">
                <i class="material-icons">more_vert</i>
            </button>
            <ul class="bg-menusub-mobile mdl-menu mdl-js-menu mdl-menu--bottom-right mdl-js-ripple-effect"
                for="more-button">
                <li class="mdl-menu__item"><a href="../../../BGDatabase">BG Database</a></li>
                <li class="mdl-menu__item"><a href="../../../BGLocalization">BG Localization</a></li>
                <li class="mdl-menu__item"><a href="../../../BGCurve">BG Curve</a></li>
                <li class="mdl-menu__item"><a href="../../../Support">Support</a></li>
            </ul>
        </div>
    </div>

<!--        <div style="min-height: 5px;background-color: #CCCCCC"></div>-->
<!--        <div id="aBox" style="background-color: #ff69b4;height: 20px;color: white;text-align: center;">
            <b>
                MESSAGE HERE
        </b>
    </div>-->

    <div class="mdl-layout__content">
        <a name="top"></a>

        <!--======================================================        Content (from Root)              -->
        




<link rel="stylesheet" href="../../../css/bgdatabase.css">
<link rel="stylesheet" href="../../../css/magnific-popup.css">
<script src="../../../js/jquery.magnific-popup.min.js"></script>

<script>
    $(document).ready(function () {
        $('.bg-image').magnificPopup({
            delegate: 'a',
            type: 'image',
//            gallery:{enabled:true},
            closeOnContentClick: true
        });
    });
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/rainbow.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<!--======================================================       BG Database Header               -->


<div class="mdl-grid">
    <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-tablet mdl-cell--hide-phone bg-sm  mdl-shadow--3dp">
        <ul id="leftmenu">
            <li class="pli databaseicon ">
                <script async src="https://cse.google.com/cse.js?cx=e1930f586f83c4862">
                </script>
                <div class="gcse-searchbox-only"></div>
                <a class="pa" href="../../../BGDatabase">BG Database Home</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Setup">Setup</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/HowToUse">How to use</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/GUIOverview">GUI overview</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/GUITips">GUI tips and tricks</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/CodeExamples">Code Examples</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Videos">Videos</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/SupportedFields">Field types</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ExportImport">Export Import</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/DataBinding">Data Binding</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/GraphEditor">Graph Editor</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/MergeTool">Merge Tools</a>
                    </li>
                    <li class="cli  plic ">
                        <a class="ca" href="../../../BGDatabase/Misc">Misc</a>
                    </li>
                    <li class="cli downloadicon ">
                        <a class="ca" href="../../../BGDatabase/Downloads">Downloads</a>
                    </li>
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../../BGDatabase/CodeGeneration">Code Generation</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/CodeGeneration/ExtensionClasses">Extension Classes</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/CodeGeneration/MonoBehaviourClasses">MonoBehavior
                            Classes</a>
                    </li>
                    <!--
                                        <li class="cli ">
                                            <a class="ca" href="../../../BGDatabase/CodeGeneration/DnaClasses">Dna Classes</a>
                                        </li>
                    -->
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../../BGDatabase/ThirdParty">Third-Party Integration</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/Excel">Excel</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/GoogleSheets">Google Sheets</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/Bolt">Unity Visual Scripting (ex-Bolt)</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/Behavior">Unity Behavior</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/Playmaker">Playmaker</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/FlowCanvas">Flow Canvas</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/NodeCanvas">Node Canvas</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/BehaviorDesigner">Behavior Designer</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/UNode">UNode</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/GameCreator">Game Creator</a>
                    </li>
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../../BGDatabase/Addons">Addons</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/SaveLoad">Save Load</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/CodeGeneration">Code Generation</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/LazyLoad">Lazy Load</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/LiveUpdate">Live Update</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/Multithreading">Multithreading</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/Modding">Modding</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/Settings">Settings</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/Partition">Partitions</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/Diagram">Diagram</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/Localization">Localization</a>
                    </li>
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../../BGDatabase/API">API</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/API/BGRepo">BGRepo</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/API/BGMetaEntity">BGMetaEntity</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/API/BGEntity">BGEntity</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/API/BGField">BGField</a>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
    <div class="mdl-cell--hide-desktop mdl-cell--hide-tablet mdl-cell--4-col-phone">
        <a class="pa" href="../../../BGDatabase">BG BGDatabase Home</a>
        <a class="pa" href="../../../BGDatabase/Setup">Setup</a>
        <a class="pa" href="../../../BGDatabase/HowToUse">How To Use</a>
        <a class="pa" href="../../../BGDatabase/Videos">Videos</a>
        <a class="pa" href="../../../BGDatabase/ExampleBreakdown">Example Breakdown</a>
        <a class="pa" href="../../../BGDatabase/SupportedFields">Fields</a>
        <a class="pa" href="../../../BGDatabase/ExportImport">Export Import</a>
        <a class="pa" href="../../../BGDatabase/DataBinding">Data Binding</a>
        <a class="pa" href="../../../BGDatabase/Events">Events</a>
        <a class="pa" href="../../../BGDatabase/CodeGeneration">Code Generation</a>
        <a class="pa" href="../../../BGDatabase/Addons">Addons</a>
    </div>
    <div class="mdl-cell mdl-cell--9-col mdl-cell--6-col-tablet mdl-cell--3-col-phone">
        <div class="bg-main mdl-shadow--3dp">
            <div class="bg-main-title">
                <h3>Misc</h3>
                
                <div style="margin-bottom: 10px;">
                    <div class="subTitle"><a class="backButton" href="../">&#8592; Back</a> Events guide</div>
                </div>
                
            </div>

            <!--======================================================        BG Database Content              -->
            <div id="content">
                


<h4>Description</h4>
<p>
    Events let use listen to database changes, like changing the field or entity, adding or removing entities. Make sure
</p>
<ol>
    <li>To pair adding a listener with removing a listener to prevent memory leaks</li>
    <li>all events handlers have try/catch block to <a href="https://stackoverflow.com/a/8745599">prevent exception being fired from event handlers</a></li>
</ol>
<p>
    Following events are available:
</p>
<table class="contentTable">
    <tr>
        <th width="20%">
            Event
        </th>
        <th>
            Description
        </th>
    </tr>
    <tr>
        <td>Field value changed</td>
        <td>It is fired when provided field value change (any entity)</td>
    </tr>
    <tr>
        <td>Entity is updated</td>
        <td>It is fired when provided entity value change (any field)</td>
    </tr>
    <tr>
        <td>Entity is deleted</td>
        <td>It is fired when provided entity deleted</td>
    </tr>
    <tr>
        <td>Any entity is updated</td>
        <td>It is fired when any entity updated (any field)</td>
    </tr>
    <tr>
        <td>Any entity is added</td>
        <td>It is fired when new entity is added</td>
    </tr>
    <tr>
        <td>Any entity is deleted</td>
        <td>It is fired when any entity deleted</td>
    </tr>
    <tr>
        <td>Before any entity deleted</td>
        <td>It is fired before any entity is deleted</td>
    </tr>
    <tr>
        <td>Batch update event</td>
        <td>Batch update event is fired when BGRepo.I.Events.Batch(Action action); method is used.
            When this method is used, no individual events will be fired while action is being executed,
            and one single batch event will be fired when action is executed.
            This is required for performance's sake when massive changes to database should be done without firing individual events
        </td>
    </tr>
    <tr>
        <td>Any change event</td>
        <td>It is fired on any database change</td>
    </tr>
</table>

<h4>Example</h4>
<p>
    The following class demonstrates the usage of events.
    The example code does not use code generation feature, so if you use <a href="../../Addons/CodeGeneration">CodeGen addon</a>,
    the following code can be simplified
</p>

<details>
    <summary>Press to see the code</summary>
    <pre class="nomargin"><code class="language-csharp">using BansheeGz.BGDatabase;
using UnityEngine;

public class EventListenersDemo : MonoBehaviour
{
    void Start() => AddListeners();
    private void OnDestroy() => RemoveListeners();
    private void AddListeners()
    {
        //get target objects
        var meta = BGRepo.I["MyTable"];
        var field = meta.GetField("name");
        var entity = meta.GetEntity(0);

        //listen to some field change
        field.ValueChanged += FieldChanged;

        //listen to particular entity (row)
        meta.AddEntityUpdatedListener(entity.Id, EntityUpdated);
        meta.AddEntityDeletedListener(entity.Id, EntityDeleted);

        //listen to all entities (rows) of particular table (meta)
        meta.AnyEntityUpdated += SomeEntityUpdated;
        meta.AnyEntityAdded += SomeEntityAdded;
        meta.AnyEntityBeforeDeleted += SomeEntityBeforeDeleted;
        meta.AnyEntityDeleted += SomeEntityDeleted;

        //listen to batch events (any table). See BatchEventExample method below for more information
        BGRepo.I.Events.OnBatchUpdate += BatchUpdate;

        //listen on any change events (any table)
        BGRepo.I.Events.OnAnyChange += AnyChange;
    }

    //always match adding listeners with removing listeners to prevent memory leak
    private void RemoveListeners()
    {
        //get target objects
        var meta = BGRepo.I["MyTable"];
        var field = meta.GetField("name");
        var entity = meta.GetEntity(0);

        meta.RemoveEntityUpdatedListener(entity.Id, EntityUpdated);
        meta.RemoveEntityDeletedListener(entity.Id, EntityDeleted);

        meta.AnyEntityUpdated -= SomeEntityUpdated;
        meta.AnyEntityAdded -= SomeEntityAdded;
        meta.AnyEntityBeforeDeleted -= SomeEntityBeforeDeleted;
        meta.AnyEntityDeleted -= SomeEntityDeleted;

        field.ValueChanged -= FieldChanged;

        BGRepo.I.Events.OnBatchUpdate -= BatchUpdate;

        BGRepo.I.Events.OnAnyChange -= AnyChange;
    }

    //------------------------------------------------
    //            Field changed
    //------------------------------------------------
    private void FieldChanged(object sender, BGEventArgsField e)
    {
        if (e is BGEventArgsFieldWithValue&lt;string&gt; ev) Debug.Log($"The field {ev.Field.Name} for entity {ev.Entity.Name} was changed {ev.OldValue} -> {ev.NewValue}");
        else Debug.Log($"The field value was changed, entity={e.Entity.Name}");
    }
    //------------------------------------------------
    //             any entity (row)
    //------------------------------------------------
    private void SomeEntityUpdated(object sender, BGEventArgsAnyEntityUpdated e)
    {
        if (e is BGEventArgsAnyEntityUpdatedWithValue ev) Debug.Log($"The field {ev.GetField().Name} for entity {ev.Entity.Name} was changed {ev.GetOldValue()} -> {ev.GetNewValue()}");
        else Debug.Log("The entity Updated " + e.Entity.Name);
    }
    private void SomeEntityAdded(object sender, BGEventArgsAnyEntity e) => Debug.Log($"The entity is added {e.Entity.Id}");
    private void SomeEntityBeforeDeleted(object sender, BGEventArgsAnyEntity e)=> Debug.Log($"The entity is about to be deleted {e.Entity.Id}");
    private void SomeEntityDeleted(object sender, BGEventArgsAnyEntity e) => Debug.Log($"The entity is deleted {e.Entity.Id}");
    //------------------------------------------------
    //             particular (provided) entity (row)
    //------------------------------------------------
    private void EntityDeleted(object sender, BGEventArgsEntity e) => Debug.Log($"The Entity was deleted {e.Entity.Id}");
    private void EntityUpdated(object sender, BGEventArgsEntityUpdated e) => Debug.Log($"The Entity was updated {e.Entity.Name}");

    //------------------------------------------------
    //            Batch update
    //------------------------------------------------
    private void BatchUpdate(object sender, BGEventArgsBatch e) => Debug.Log($"Batch update. Use WasEntitiesAdded/WasEntitiesDeleted/WasEntitiesUpdated methods to find out if entities were modified");

    //this method provide example how batch event is fired
    private void BatchEventExample()
    {
        BGRepo.I.Events.Batch(() =>
        {
            //all individual events inside this method will be disabled. One batch event will be fired when this action is executed
            //update all "name" field values for the first table
            BGRepo.I.GetMeta(0).ForEachEntity(entity => entity.Name += " [Updated]");
        });
    }


    //------------------------------------------------
    //            Any change
    //------------------------------------------------
    private void AnyChange(object sender, BGEventArgsAnyChange e) => Debug.Log($"Some change was made to the database");

}</code></pre>
</details>
            </div>
            
            <a class="backToDownloads" href="../" style="margin-top: 10px">&#8592; Back to Misc</a>
            

            <!--======================================================       BG Database Footer               -->
        </div>

    </div>
</div>



        <!--======================================================      Root Footer               -->
        <footer class="bg-footer mdl-mega-footer" style="clear:both;">
            <div class="mdl-mega-footer--top-section">
                <div class="mdl-mega-footer--middle-section bg-footer-email">
                    <table>
                        <tr>
                            <td>
                                <script language="JavaScript">
                                    writeEmail("support", "bansheegz.com")
                                </script>
                            </td>
                            <td>
                                or
                            </td>
                            <td>
                                <script language="JavaScript">
                                    writeEmail("admin", "bansheegz.com")
                                </script>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div style="text-align: center">
                <div id="share" style="display: inline-block;"></div>
            </div>
        </footer>
    </div>
</div>


</div>

<script defer src="https://code.getmdl.io/1.2.1/material.min.js"></script>

</body>
</html>
