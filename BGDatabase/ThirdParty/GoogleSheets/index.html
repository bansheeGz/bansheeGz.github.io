<!doctype html>
<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-76367732-7"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-76367732-7');
    </script>

    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="BG Database is a in-game data management system for Unity3D game engine">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    
    <title>BansheeGz</title>

    <!-- Page styles -->
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="../../../css/font-awesome.min.css">
    <link rel="stylesheet" href="https://code.getmdl.io/1.2.1/material.min.css">

    <link rel="stylesheet" href="../../../css/main.css">
    <link rel="stylesheet" href="../../../css/page.css">

    <link rel="icon" type="image/png" href="../../../images/BGIcon.png"/>
</head>
<body>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<style>
    #aBox a {
        color: white;
        font: 15px Helvetica, Arial, Sans-Serif;
    }

    #bg-navigation a {
        background-position: 50px;
    }
</style>


<script>
    function writeEmail(whom, at) {
        document.write("<a href='mail" + "to:" + whom + "@" + at + "'>" + whom + "@" + at + "</a>");
    }
</script>

<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">

    <!--======================================================       Root  Header               -->
    <div class="bg-header mdl-layout__header mdl-layout__header--waterfall">
        <div class="mdl-layout__header-row" id="header">
          <span style="margin-left: -40px;">
              <a class="bg-header-a" href="/"><img src="../../../images/BGIconBig.png"></a>
          </span>
            <!-- Add spacer, to align navigation to the right in desktop -->
            <div class="mdl-layout-spacer"></div>
            <!-- Navigation -->
            <div class="bg-navigation-bag" id="bg-navigation">
                <nav class="bg-navigation mdl-navigation">
                    <a class="mdl-navigation__link mdl-typography--text-uppercase bg-navigation_link_active"
                       href="../../../BGDatabase">BG`Database</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../../BGLocalization">BG`Localization</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../../BGCurve">BG`Curve</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../../BGCurve/BGSplineColliders">BG`Spline_Colliders</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../../Blog">Blog</a>
                    <a class="mdl-navigation__link mdl-typography--text-uppercase "
                       href="../../../Support">Support</a>
                </nav>
            </div>
            <button class="bg-menu-mobile mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect"
                    id="more-button">
                <i class="material-icons">more_vert</i>
            </button>
            <ul class="bg-menusub-mobile mdl-menu mdl-js-menu mdl-menu--bottom-right mdl-js-ripple-effect"
                for="more-button">
                <li class="mdl-menu__item"><a href="../../../BGDatabase">BG Database</a></li>
                <li class="mdl-menu__item"><a href="../../../BGLocalization">BG Localization</a></li>
                <li class="mdl-menu__item"><a href="../../../BGCurve">BG Curve</a></li>
                <li class="mdl-menu__item"><a href="../../../Support">Support</a></li>
                <li class="mdl-menu__item"><a href="../../../About">About Us</a></li>
            </ul>
        </div>
    </div>

    <!--
        <div style="min-height: 5px;background-color: #CCCCCC"></div>
        <div id="aBox" style="background-color: #ff69b4;height: 20px;color: white;text-align: center;">
            <b>
                Announcement: <a href="../../../BGDatabase"><b>BG Database</b></a> v. 1.1 is out!
        </b>
    </div>
    -->

    <div class="mdl-layout__content">
        <a name="top"></a>


        <!--======================================================        Content (from Root)              -->
        




<link rel="stylesheet" href="../../../css/bgdatabase.css">
<link rel="stylesheet" href="../../../css/magnific-popup.css">
<script src="../../../js/jquery.magnific-popup.min.js"></script>

<script>
    $(document).ready(function () {
        $('.bg-image').magnificPopup({
            delegate: 'a',
            type: 'image',
//            gallery:{enabled:true},
            closeOnContentClick: true
        });
    });
</script>

<!--======================================================       BG Database Header               -->


<div class="mdl-grid">
    <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-tablet mdl-cell--hide-phone bg-sm  mdl-shadow--3dp">
        <ul id="leftmenu">
            <li class="pli curveicon ">
                <a class="pa" href="../../../BGDatabase">BG Database Home</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Setup">Setup</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/HowToUse">How to use</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/CodeExamples">Code Examples</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Videos">Videos</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ExampleBreakdown">Example Breakdown</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/SupportedFields">Field types</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ExportImport">Export Import</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/DataBinding">Data Binding</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Multithreading">Multithreading</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/MergeTool">Merge Tool</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Misc">Misc</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Downloads">Downloads</a>
                    </li>
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../../BGDatabase/CodeGeneration">Code Generation</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/CodeGeneration/ExtensionClasses">Extension Classes</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/CodeGeneration/MonoBehaviourClasses">MonoBehavior Classes</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/CodeGeneration/DnaClasses">Dna Classes</a>
                    </li>
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../../BGDatabase/ThirdParty">Third-Party Integration</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/Excel">Excel</a>
                    </li>
                    <li class="cli  plic ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/GoogleSheets">Google Sheets</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/Playmaker">Playmaker</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/ThirdParty/Bolt">Bolt</a>
                    </li>
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../../BGDatabase/Addons">Addons</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/Settings">Settings</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/SaveLoad">Save Load</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/CodeGeneration">Code Generation</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/LazyLoad">Lazy Load</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/LiveUpdate">Live Update</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/Multithreading">Multithreading</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/Addons/Localization">Localization</a>
                    </li>
                </ul>
            </li>
            <li class="pli ">
                <a class="pa " href="../../../BGDatabase/API">API</a>
                <ul>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/API/BGRepo">BGRepo</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/API/BGMetaEntity">BGMetaEntity</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/API/BGEntity">BGEntity</a>
                    </li>
                    <li class="cli ">
                        <a class="ca" href="../../../BGDatabase/API/BGField">BGField</a>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
    <div class="mdl-cell--hide-desktop mdl-cell--hide-tablet mdl-cell--4-col-phone">
        <a class="pa" href="../../../BGDatabase">BG BGDatabase Home</a>
        <a class="pa" href="../../../BGDatabase/Setup">Setup</a>
        <a class="pa" href="../../../BGDatabase/HowToUse">How To Use</a>
        <a class="pa" href="../../../BGDatabase/Videos">Videos</a>
        <a class="pa" href="../../../BGDatabase/ExampleBreakdown">Example Breakdown</a>
        <a class="pa" href="../../../BGDatabase/SupportedFields">Fields</a>
        <a class="pa" href="../../../BGDatabase/ExportImport">Export Import</a>
        <a class="pa" href="../../../BGDatabase/DataBinding">Data Binding</a>
        <a class="pa" href="../../../BGDatabase/Events">Events</a>
        <a class="pa" href="../../../BGDatabase/CodeGeneration">Code Generation</a>
        <a class="pa" href="../../../BGDatabase/Addons">Addons</a>
    </div>
    <div class="mdl-cell mdl-cell--9-col mdl-cell--6-col-tablet mdl-cell--3-col-phone">
        <div class="bg-main mdl-shadow--3dp">
            <div class="bg-main-title">
                <h3>Google Sheets</h3>
            </div>

            <!--======================================================        BG Database Content              -->
            <div id="content">
            

<div class="importantNote">
    Main article about Export/Import is <a href="../../ExportImport">here</a>
</div>
<br/>

<h4>Description</h4>
<p>
    Setting up Google sheets may take a while, however it's one-time procedure.
    If you have more than one developer in your project who can run export tasks,
    read <a href="#shared">"Using Google sheets as shared remote database"</a> section at the bottom of the page
</p>

<h4>Create Google Sheets DataSource</h4>
<p>
    Open BGDatabase window <code>Window->BGDatabase</code>
</p>
<p>
    Go to <code>DataSources</code> tab, press plus icon, chose <code>Datasource type</code> to be <code>GoogleSheets</code> and click <code>Add</code> button
</p>
<div class="bg-image">
    <a href="../../../images/BGDatabase/GoogleSheets4.png"><img style="width: 400px" src="../../../images/BGDatabase/GoogleSheets4.png"></a>
</div>


<h4>Create Google client Id</h4>
<p>
    Here is our step-by-step guide how to do it (alternatively use this Google support <a href="https://support.google.com/googleapi/answer/6158849">article</a>)
</p>
<ol>
    <li>Log in to <a href="https://console.developers.google.com/">Google Console</a></li>
    <li>Select or create a project
        <div class="bg-image">
            <a href="../../../images/BGDatabase/GoogleSheets1.png"><img style="width: 400px" src="../../../images/BGDatabase/GoogleSheets1.png"></a>
        </div>
    </li>
    <li>Select <code>Credentials</code> , click on <code>Create credentials</code> and chose <code>Oath client Id</code>
        <div class="bg-image">
            <a href="../../../images/BGDatabase/GoogleSheets2.png"><img style="width: 400px" src="../../../images/BGDatabase/GoogleSheets2.png"></a>
        </div>
    </li>
    <li>Chose <code>Other</code> and click <code>Create</code>
        <div class="bg-image">
            <a href="../../../images/BGDatabase/GoogleSheets3.png"><img style="width: 400px" src="../../../images/BGDatabase/GoogleSheets3.png"></a>
        </div>
    </li>
    <li>A popup will show up with your client id and client secret. Copy them to your Datasource settings
        <div class="bg-image">
            <a href="../../../images/BGDatabase/GoogleSheets5.png"><img style="width: 400px" src="../../../images/BGDatabase/GoogleSheets5.png"></a>
        </div>
    </li>
</ol>

<h4>Filling Application name and Spreadsheet Id</h4>
<ol>
    <li>Fill <code>Application name</code> with any string value</li>
    <li>Fill <code>Spreadsheet Id</code> with your spreadsheet ID.
        Please, see the image below to learn how to obtain ID or read <a href="https://developers.google.com/sheets/api/guides/concepts#spreadsheet_id">this</a>
    </li>
</ol>
<div class="bg-image">
    <a href="../../../images/BGDatabase/GoogleSheets11.png"><img style="width: 400px" src="../../../images/BGDatabase/GoogleSheets11.png"></a>
</div>

<h4>Get Oath tokens from Google</h4>
<ol>
    <li>Click on <code>Get new tokens</code> button
        <div class="bg-image">
            <a href="../../../images/BGDatabase/GoogleSheets6.png"><img style="width: 400px" src="../../../images/BGDatabase/GoogleSheets6.png"></a>
        </div>
    </li>
    <li>Your browser will open up, with login to Google account and permission request. Login and click <code>Allow</code>
        <div class="bg-image">
            <a href="../../../images/BGDatabase/GoogleSheets7.png"><img style="width: 400px; height: 100px" src="../../../images/BGDatabase/GoogleSheets7.png"></a>
        </div>
    </li>
    <li>Single page will be displayed with single text field. Copy it's value and switch back to Unity
        <div class="bg-image">
            <a href="../../../images/BGDatabase/GoogleSheets8.png"><img style="width: 400px; height: 100px" src="../../../images/BGDatabase/GoogleSheets8.png"></a>
        </div>
    </li>

    <li>Unity will display a small popup window with single text field. Paste the copied value and press <code>Go!</code>
        <div class="bg-image">
            <a href="../../../images/BGDatabase/GoogleSheets9.png"><img style="width: 400px; height: 100px" src="../../../images/BGDatabase/GoogleSheets9.png"></a>
        </div>
    </li>

    <li>That's it. Tokens field will be filled and you can save settings- datasource is ready.
        <div class="bg-image">
            <a href="../../../images/BGDatabase/GoogleSheets10.png"><img style="width: 400px;" src="../../../images/BGDatabase/GoogleSheets10.png"></a>
        </div>
    </li>
</ol>

<h4>Create Export/Import task</h4>
<p>
    Go to <code>Export/Import</code> tab, press plus icon, chose <code>Job type</code> to be <code>GoogleSheets</code> and click <code>Add</code> button
</p>
<p>
    Chose GoogleSheets datasource, created above. Set up metas (tables) you wish to update.
</p>

<h4>Running Export/Import Task</h4>
<p>
    Press <code>Export</code> or <code>Import</code> button to run the task you just created.
</p>

<p>
    [Optionally] After job is finished, open <code>Log</code> tab to see full log of all actions performed.
    Pay attention to Warning messages (colored red). Every error or unexpected event happened during syncing will be colored red.
</p>
<div class="bg-image">
    <a href="../../../images/BGDatabase/Excel5.png"><img style="width: 400px" src="../../../images/BGDatabase/Excel5.png"></a>
</div>

<div class="importantNote">
    Target empty spreadsheet while exporting for the first time. Export job will create necessary sheets/header rows + data for you
    (<a href="../../ExportImport/index.html#firstTime">more information</a>)
</div>
<p>
    Make sure you have as many physical rows/columns as you need, delete empty rows/columns to boost performance.
</p>

<h4 id="shared">Using Google sheets as shared remote database</h4>
<p>
    You can use Google Sheets as remote shared database to be used by several developers (during game development),
    but be aware, there is a problem of 2 export tasks running simultaneously, which needs to be addressed somehow.
</p>
<h6>TLDR:</h6>
<ol>
    <li>There is a problem, which can occur during simultaneous export tasks under specific conditions, which can lead to data end up in wrong rows</li>
    <li>To prevent the risk, create additional sheet with name _dblock_ (with underscores) and single cell (A1).
        There still be a tiny chance to run into issues, but in this case you will get a warning.</li>
    <li>We are researching opportunities to make prevention mechanism 100% robust with zero setup</li>
</ol>
<h6>Required conditions for this problem:</h6>
<ol>
    <li>At least two export tasks should run simultaneously</li>
    <li>One of the tasks removes rows from the table(sheet) and another one performs any operation to the same table</li>
    <li>Both tasks adds rows to the same table</li>
</ol>
<h6>Problem consequences:</h6>
<p>
    Data may end up in wrong rows
</p>
<h6>Our solution to this problem:</h6>
<p>
    Locking mechanism, which tries to prevent 2 export tasks from running simultaneously (not 100% robust currently)
</p>

<h6>How to enable it and how it works:</h6>
<ol>
    <li>Create additional sheet with name <b>_dblock_</b> and one single empty cell (A1).</li>
    <li>If this sheet exists, export task will read cell A1 value before export and if it's not empty export will be aborted.</li>
    <li>If cell A1 is empty- export task write some value to it before modifying data to identify the spreadsheet is locked and clear it after export is complete.</li>
</ol>
<h6>Important notes:</h6>
<p>
    Locking mechanism minimize the risk of data collision.
    However, there will still be a tiny chance 2 export task run simultaneously, cause obtaining the lock is not atomic operation currently.
    In this case you should get a warning about possible data collision after export is complete (warning text is "Export was successful, but possible data collision was detected..")
    and you may need to review the data and run clear export in case of any issues.
<p>
    If Google API could provide a way to lock spreadsheet before export- it would be a proper solution for this problem, but there is no such option.
</p>


<h4>GoogleSheets API v.4 and Older Unity versions</h4>
<p>
    Since BGDatabase v.1.5 we switched from Google Sheets API v.3 to v.4.
    If you use Unity 2017-2018, make sure your scripting runtime is set to 4.x. Read more details <a href="../../../Blog/BGDatabase-GoogleSheetsV4">here</a>
</p>

            </div>

            <!--======================================================       BG Database Footer               -->
        </div>

    </div>
</div>



        <!--======================================================      Root Footer               -->
        <footer class="bg-footer mdl-mega-footer" style="clear:both;">
            <div class="mdl-mega-footer--top-section">
                <div class="mdl-mega-footer--middle-section bg-footer-email">
                    <table>
                        <tr>
                            <td>
                                <script language="JavaScript">
                                    writeEmail("support", "bansheegz.com")
                                </script>
                            </td>
                            <td>
                                or
                            </td>
                            <td>
                                <script language="JavaScript">
                                    writeEmail("admin", "bansheegz.com")
                                </script>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div style="text-align: center">
                <div id="share" style="display: inline-block;"></div>
            </div>
        </footer>
    </div>
</div>


</div>

<script defer src="https://code.getmdl.io/1.2.1/material.min.js"></script>

</body>
</html>
